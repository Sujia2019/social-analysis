(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-66e5e66e"],{"10bb":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-card",{staticClass:"box-card"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[n("el-table-column",{attrs:{prop:"user_account",label:"账号",width:"180"}}),n("el-table-column",{attrs:{prop:"sname",label:"姓名",width:"180"}}),n("el-table-column",{attrs:{prop:"gender",label:"性别",width:"180",formatter:e.formatGender}}),n("el-table-column",{attrs:{prop:"email",label:"邮箱"}}),n("el-table-column",{attrs:{prop:"phone",label:"手机"}}),n("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(n){return e.handleEdit(t.$index,t.row)}}},[e._v("详情")]),n("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(n){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1)],1),n("el-drawer",{attrs:{title:"好友详情",visible:e.drawer,direction:e.direction,"before-close":e.handleClose},on:{"update:visible":function(t){e.drawer=t}}},[n("el-card",{staticClass:"box-card",staticStyle:{height:"calc(100vh - 77px)"}},[n("el-row",[n("el-col",{attrs:{span:12}},[n("el-tag",{attrs:{type:"success"}},[e._v("姓名")]),e._v(":"+e._s(e.drawerFriend.sname))],1),n("el-col",{attrs:{span:12}},[n("el-tag",{attrs:{type:"success"}},[e._v("性别")]),e._v(":"+e._s(0==e.drawerFriend.gender?"男":"女"))],1)],1),n("el-row",[n("el-col",{attrs:{span:12}},[n("el-tag",{attrs:{type:"success"}},[e._v("电话")]),e._v(":"+e._s(e.drawerFriend.phone))],1),n("el-col",{attrs:{span:12}},[n("el-tag",{attrs:{type:"success"}},[e._v("邮箱")]),e._v(":"+e._s(e.drawerFriend.email))],1)],1),n("el-row",[n("el-col",{attrs:{span:12}},[n("el-tag",{attrs:{type:"success"}},[e._v("大学")]),e._v(":"+e._s(e.drawerFriend.collage))],1),n("el-col",{attrs:{span:12}},[n("el-tag",{attrs:{type:"success"}},[e._v("专业")]),e._v(":"+e._s(e.drawerFriend.major))],1)],1),n("el-divider",[e._v("message board")]),n("div",{staticStyle:{height:"calc(100% - 224px)","overflow-y":"auto"}},e._l(e.drawerBoard,(function(t,a){return n("div",{key:a},[n("el-tag",{staticStyle:{"font-size":"16px"},attrs:{type:"warning",size:"small"}},[e._v(e._s(t.from_name))]),e._v(": "),n("span",{staticStyle:{"font-size":"16px","line-height":"12px"}},[e._v(e._s(t.board_text))]),n("div",{staticStyle:{display:"flex","justify-content":"flex-end","font-size":"14px"}},[e._v(e._s(t.date_time))]),n("el-divider")],1)})),0),n("div",[n("el-row",[n("el-col",{attrs:{span:20}},[n("el-input",{staticStyle:{"max-height":"54px"},attrs:{type:"textarea",placeholder:"请输入留言内容",maxlength:"100","show-word-limit":""},model:{value:e.boardInputInfo,callback:function(t){e.boardInputInfo=t},expression:"boardInputInfo"}})],1),n("el-col",{attrs:{span:4}},[n("el-button",{staticStyle:{height:"54px","margin-left":"5px"},attrs:{type:"primary"},on:{click:e.addBoardMsg}},[e._v("发送")])],1)],1)],1)],1)],1),n("el-dialog",{attrs:{title:"添加好友",visible:e.dialogAddFriendVisible,width:"60%"},on:{"update:visible":function(t){e.dialogAddFriendVisible=t}}},[n("div",{staticStyle:{display:"flex","justify-content":"flex-start","margin-bottom":"20px"}},[n("el-input",{staticStyle:{width:"220px"},attrs:{size:"mini",placeholder:"账号"},model:{value:e.queryInfo.user_account,callback:function(t){e.$set(e.queryInfo,"user_account",t)},expression:"queryInfo.user_account"}}),n("el-input",{staticStyle:{width:"220px","margin-left":"10px"},attrs:{size:"mini",placeholder:"姓名"},model:{value:e.queryInfo.sname,callback:function(t){e.$set(e.queryInfo,"sname",t)},expression:"queryInfo.sname"}}),n("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"mini",type:"primary"},on:{click:e.findUsersByLikeQuery}},[e._v("搜索")])],1),n("el-table",{attrs:{data:e.userListData,border:"",size:"mini"}},[n("el-table-column",{attrs:{prop:"user_account",label:"账号"}}),n("el-table-column",{attrs:{prop:"sname",label:"姓名"}}),n("el-table-column",{attrs:{prop:"major",label:"专业"}}),n("el-table-column",{attrs:{label:"操作",width:"240px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(n){return e.handleEdit(t.$index,t.row)}}},[e._v("查看详情")]),e.friendAccountArr.includes(t.row.user_account)?n("el-button",{attrs:{size:"mini",type:"success",disabled:"",plain:""}},[e._v("已添加")]):e.sendAccountArr.includes(t.row.user_account)?n("el-button",{attrs:{size:"mini",type:"primary",disabled:"",plain:""}},[e._v("已发送申请")]):n("el-button",{attrs:{size:"mini",type:"warning",plain:""},on:{click:function(n){return e.handleSend(t.$index,t.row)}}},[e._v("提交好友申请")])]}}])})],1)],1),n("el-dialog",{attrs:{title:"好友申请",visible:e.dialogAddRequestVisible,width:"60%"},on:{"update:visible":function(t){e.dialogAddRequestVisible=t}}},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.requestData}},[n("el-table-column",{attrs:{prop:"account",label:"账号",width:"160"}}),n("el-table-column",{attrs:{prop:"detail",label:"申请信息",width:"300"}}),n("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(n){return e.handleAgree(t.$index,t.row)}}},[e._v("同意")]),n("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(n){return e.handleRefuse(t.$index,t.row)}}},[e._v("拒绝")])]}}])})],1)],1),n("el-dialog",{attrs:{title:"我的申请",visible:e.dialogMyRequestVisible,width:"60%"},on:{"update:visible":function(t){e.dialogMyRequestVisible=t}}},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.myRequestData}},[n("el-table-column",{attrs:{prop:"account",label:"账号",width:"180"}}),n("el-table-column",{attrs:{prop:"detail",label:"申请信息"}}),n("el-table-column",{attrs:{label:"操作",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(n){return e.handleCancel(t.$index,t.row)}}},[e._v("取消")])]}}])})],1)],1)],1)},r=[],s=(n("4de4"),n("d81d"),n("310c")),i=n("96c3"),o=n("47d7"),l=n("ca00"),u={name:"Friend",data:function(){return{tableData:[],userListData:[],userSearchData:[],requestData:[{}],myRequestData:[{}],friendAccountArr:[],sendAccountArr:[],dialogAddFriendVisible:!1,dialogAddRequestVisible:!1,dialogMyRequestVisible:!1,friend:{account1:"",account2:"",addStatus:0,detail:""},queryInfo:{user_account:"",sname:""},formLabelWidth:"120px",loginInfo:"",addRequestNum:"",myRequestNum:"",drawer:!1,direction:"rtl",drawerFriend:{},drawerBoard:{},boardInputInfo:""}},mounted:function(){this.loginInfo=Object(l["b"])(),this.queryFriendList(),this.getRequest(1),this.getRequest(0)},methods:{queryFriendList:function(){var e=this;s["a"].queryFriends({account:this.loginInfo.user_account}).then((function(t){console.log(t),666===t.code&&(e.tableData=t.obj)}))},getRequest:function(e){var t=this;s["a"].getRequest({account:this.loginInfo.user_account,flag:e}).then((function(n){666===n.code?1===e?(t.addRequestNum=0==n.obj.length?"":n.obj.length,t.requestData=n.obj):(t.myRequestNum=0==n.obj.length?"":n.obj.length,t.myRequestData=n.obj):t.$message.error("加载好友申请信息失败")}))},queryAllUser:function(){var e=this;this.friendAccountArr=this.tableData.map((function(e){return e.user_account})),this.sendAccountArr=this.requestData.map((function(e){return e.account})),this.dialogAddFriendVisible=!0,i["a"].findAll({index:1,perPage:100}).then((function(t){666===t.code&&(t.obj=t.obj.filter((function(e){return e.user_account!=Object(l["b"])().user_account})),console.log(t.obj),e.userListData=t.obj)}))},addBoardMsg:function(){var e=this,t={};t.user_account=this.drawerFriend.user_account,t.from_account=this.loginInfo.user_account,t.board_text=this.boardInputInfo,t.from_name=this.drawerFriend.sname,o["a"].addBoardMsg(t).then((function(t){666===t.code?(e.$message.success(t.message),o["a"].queryBoardMsg({account:e.drawerFriend.user_account}).then((function(t){666===t.code&&(e.drawerBoard=t.obj)}))):e.$message.error(t.message)}))},findUsersByLikeQuery:function(){var e=this;this.friendAccountArr=this.tableData.map((function(e){return e.user_account})),this.sendAccountArr=this.requestData.map((function(e){return e.account})),this.dialogAddFriendVisible=!0,""===this.queryInfo.user_account&&delete this.queryInfo.user_account,""===this.queryInfo.sname&&delete this.queryInfo.sname,i["a"].findUsersByLikeQuery(this.queryInfo).then((function(t){666===t.code&&(t.obj=t.obj.filter((function(e){return e.user_account!=Object(l["b"])().user_account})),e.userListData=t.obj)}))},handleEdit:function(e,t){var n=this;console.log(e,t),this.drawer=!0,this.drawerFriend=t,o["a"].queryBoardMsg({account:t.user_account}).then((function(e){666===e.code&&(n.drawerBoard=e.obj)}))},handleSend:function(e,t){var n=this;console.log(e,t),this.$prompt("请输入申请信息","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(e){var a=e.value;n.friend.account1=Object(l["c"])().user_account,n.friend.account2=t.user_account,n.friend.detail=a,s["a"].addFriend(n.friend).then((function(e){666===e.code&&(n.$message.success(e.message),n.findUsersByLikeQuery())}))})).catch((function(){n.$message({type:"info",message:"取消申请"})}))},handleDelete:function(e,t){var n=this;this.$confirm("删除好友".concat(t.sname,"是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var e={account1:t.user_account,account2:n.loginInfo.user_account,addStatus:-1,detail:"删除"};s["a"].updateRel(e).then((function(e){666===e.code?(n.$message({type:"success",message:"删除成功!"}),n.queryFriendList()):n.$message.error(e.message)}))})).catch((function(){n.$message({type:"info",message:"已取消删除"})}))},handleAgree:function(e,t){var n=this;console.log(e,t);var a={account1:t.account,account2:this.loginInfo.user_account,addStatus:1,detail:"你是谁"};s["a"].updateRel(a).then((function(e){666===e.code&&(n.$message.success("添加成功"),n.getRequest(1),n.queryFriendList())}))},handleRefuse:function(e,t){var n=this;console.log(e,t);var a={account1:this.loginInfo.user_account,account2:t.user_account,addStatus:2,detail:"你是谁"};s["a"].updateRel(a).then((function(e){666===e.code&&(n.$message.success("操作成功"),n.getRequest(0),n.queryFriendList())}))},handleClose:function(e){this.$confirm("确认关闭？").then((function(t){e()})).catch((function(e){}))},handleCancel:function(e,t){},formatGender:function(e,t,n,a){return 0===e.gender?"男":"女"}}},c=u,d=(n("eb84"),n("2877")),p=Object(d["a"])(c,a,r,!1,null,null,null);t["default"]=p.exports},"310c":function(e,t,n){"use strict";var a=n("b775"),r=[{name:"queryFriends",url:"/friend/getFriends",type:"get"},{name:"addFriend",url:"/friend/addRequest",type:"post"},{name:"updateRel",url:"/friend/updateRel",type:"post"},{name:"getRequest",url:"/friend/getRequest",type:"get"}],s=a["a"].createApiObj(r);t["a"]=s},"47d7":function(e,t,n){"use strict";var a=n("b775"),r=[{name:"queryBoardMsg",url:"/board/showBoardMsg",type:"get"},{name:"addBoardMsg",url:"/board/addBoardMsg",type:"post"},{name:"showInfo",url:"/stu/showInfo",type:"get"},{name:"updateInfo",url:"/stu/update",type:"post"},{name:"showQuestion",url:"/question/show",type:"get"},{name:"sendAnswers",url:"/question/sendAnswers",type:"post"},{name:"isFinished",url:"/question/isFinished",type:"get"},{name:"getResult",url:"/question/getResult",type:"get"}],s=a["a"].createApiObj(r);t["a"]=s},"96c3":function(e,t,n){"use strict";var a=n("b775"),r=[{name:"findAll",url:"/admin/findAll",type:"get"},{name:"delete",url:"/admin/delete",type:"post"},{name:"findUsersByLikeQuery",url:"/admin/findUsersByLikeQuery?index=1&perPage=100",type:"post"},{name:"getChatLogsName",url:"/admin/getChatLogsName",type:"get"},{name:"getChatLog",url:"/admin/getChatLog",type:"get"}],s=a["a"].createApiObj(r);t["a"]=s},ae3a:function(e,t,n){},d81d:function(e,t,n){"use strict";var a=n("23e7"),r=n("b727").map,s=n("1dde"),i=n("ae40"),o=s("map"),l=i("map");a({target:"Array",proto:!0,forced:!o||!l},{map:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},eb84:function(e,t,n){"use strict";n("ae3a")}}]);